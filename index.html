<!DOCTYPE html>
<html lang="vi">
<head>
  <!-- ================================================================
       üí∞ MINIAPP T√ÄI CH√çNH - TELEGRAM BOT
       T·ªëi ∆∞u: Performance, UX, Responsive, Animations
       ================================================================ -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Qu·∫£n l√Ω t√†i ch√≠nh c√° nh√¢n th√¥ng minh">
  <meta name="theme-color" content="#6366F1">
  <title>üí∞ Miniapp T√†i Ch√≠nh</title>
  
  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
</head>
<body>
  
  <!-- ================================================================
       HEADER & NAVIGATION
       ================================================================ -->
  <div class="app-header">
    <h3>¬©masterhmh</h3>
  </div>
  
  <nav class="top-nav" role="navigation" aria-label="Main navigation">
    <div class="nav-item active" data-tab="tab1" role="tab" aria-selected="true">
      <i class="fas fa-exchange-alt" aria-hidden="true"></i>
      <span>Giao d·ªãch</span>
    </div>
    <div class="nav-item" data-tab="tab2" role="tab">
      <i class="fas fa-chart-pie" aria-hidden="true"></i>
      <span>B√°o c√°o</span>
    </div>
    <div class="nav-item" data-tab="tab3" role="tab">
      <i class="fas fa-receipt" aria-hidden="true"></i>
      <span>Li·ªát k√™</span>
    </div>
    <div class="nav-item" data-tab="tab4" role="tab">
      <i class="fas fa-search" aria-hidden="true"></i>
      <span>T√¨m ki·∫øm</span>
    </div>
    <div class="nav-item" data-tab="tab5" role="tab">
      <i class="fas fa-tags" aria-hidden="true"></i>
      <span>T·ª´ kh√≥a</span>
    </div>
    <div class="nav-item" data-tab="tab6" role="tab">
      <i class="fas fa-info-circle" aria-hidden="true"></i>
      <span>Gi·ªõi thi·ªáu</span>
    </div>
  </nav>

  <!-- ================================================================
       MAIN CONTENT
       ================================================================ -->
  <div class="content-wrapper">
    
    <!-- TAB 1: GIAO D·ªäCH TRONG NG√ÄY -->
    <div id="tab1" class="tab-content active" role="tabpanel">
      <h1>üí∏ GIAO D·ªäCH TRONG NG√ÄY</h1>
      
      <!-- Filter Controls -->
      <div class="input-group">
        <input type="date" id="transactionDate" aria-label="Ch·ªçn ng√†y">
        <button id="fetchTransactionsBtn">
          <i class="fas fa-filter"></i> L·ªçc
        </button>
        <button id="addTransactionBtn" class="btn-success">
          <i class="fas fa-plus"></i> Th√™m
        </button>
      </div>
      
      <!-- Summary Stats -->
      <div class="stats-container" id="dailySummary">
        <div class="stat-box income">
          <div class="title">Thu nh·∫≠p</div>
          <div class="amount">0ƒë</div>
        </div>
        <div class="stat-box expense">
          <div class="title">Chi ti√™u</div>
          <div class="amount">0ƒë</div>
        </div>
        <div class="stat-box balance">
          <div class="title">S·ªë d∆∞</div>
          <div class="amount">0ƒë</div>
        </div>
      </div>
      
      <!-- Loading & Messages -->
      <div id="loadingTab1" class="hidden">
        <div class="spinner"></div>
      </div>
      <p id="placeholderTab1" class="notification">
        Ch·ªçn ng√†y v√† nh·∫•n <strong>L·ªçc</strong> ƒë·ªÉ xem giao d·ªãch
      </p>
      
      <!-- Transactions List -->
      <div class="transactions-list" id="transactionsContainer"></div>
      
      <!-- Pagination -->
      <div id="pagination" class="pagination hidden">
        <button id="prevPage" class="pagination-btn" disabled>
          <i class="fas fa-chevron-left"></i> Tr∆∞·ªõc
        </button>
        <span id="pageInfo"></span>
        <button id="nextPage" class="pagination-btn">
          Sau <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- TAB 2: B√ÅO C√ÅO THU CHI -->
    <div id="tab2" class="tab-content" role="tabpanel">
      <h1>üìä B√ÅO C√ÅO THU CHI THEO TH√ÅNG</h1>
      
      <!-- Month Range Selector -->
      <div class="input-group">
        <label for="startMonth">T·ª´:</label>
        <select id="startMonth" aria-label="Th√°ng b·∫Øt ƒë·∫ßu">
          <option value="1">Th√°ng 1</option>
          <option value="2">Th√°ng 2</option>
          <option value="3">Th√°ng 3</option>
          <option value="4">Th√°ng 4</option>
          <option value="5">Th√°ng 5</option>
          <option value="6">Th√°ng 6</option>
          <option value="7">Th√°ng 7</option>
          <option value="8">Th√°ng 8</option>
          <option value="9">Th√°ng 9</option>
          <option value="10">Th√°ng 10</option>
          <option value="11">Th√°ng 11</option>
          <option value="12">Th√°ng 12</option>
        </select>
        
        <label for="endMonth">ƒê·∫øn:</label>
        <select id="endMonth" aria-label="Th√°ng k·∫øt th√∫c">
          <option value="1">Th√°ng 1</option>
          <option value="2">Th√°ng 2</option>
          <option value="3">Th√°ng 3</option>
          <option value="4">Th√°ng 4</option>
          <option value="5">Th√°ng 5</option>
          <option value="6">Th√°ng 6</option>
          <option value="7">Th√°ng 7</option>
          <option value="8">Th√°ng 8</option>
          <option value="9">Th√°ng 9</option>
          <option value="10">Th√°ng 10</option>
          <option value="11">Th√°ng 11</option>
          <option value="12">Th√°ng 12</option>
        </select>
        
        <button id="fetchMonthlyDataBtn">
          <i class="fas fa-filter"></i> L·ªçc
        </button>
      </div>
      
      <!-- Monthly Summary -->
      <div class="stats-container" id="monthlyStatsContainer">
        <div class="stat-box income">
          <div class="title">Thu nh·∫≠p</div>
          <div class="amount">0ƒë</div>
        </div>
        <div class="stat-box expense">
          <div class="title">Chi ti√™u</div>
          <div class="amount">0ƒë</div>
        </div>
        <div class="stat-box balance">
          <div class="title">S·ªë d∆∞</div>
          <div class="amount">0ƒë</div>
        </div>
      </div>
      
      <!-- Loading -->
      <div id="loadingTab2" class="hidden">
        <div class="spinner"></div>
      </div>
      <p id="placeholderTab2" class="notification">
        Ch·ªçn kho·∫£ng th·ªùi gian v√† nh·∫•n <strong>L·ªçc</strong> ƒë·ªÉ xem b√°o c√°o
      </p>
      
      <!-- Charts -->
      <div class="chart-section">
        <h1 id="chartTitleTab2" class="hidden">üìà Bi·ªÉu ƒë·ªì thu chi</h1>
        <canvas id="monthlyChart"></canvas>
      </div>
      
      <div class="chart-section">
        <h1 id="pieChartTitleTab2" class="hidden">ü•ß Chi ti√™u theo ph√¢n lo·∫°i</h1>
        <div class="pie-chart-wrapper">
          <canvas id="monthlyPieChart"></canvas>
        </div>
        <div class="custom-legend" id="monthlyCustomLegend"></div>
      </div>
    </div>

    <!-- TAB 3: LI·ªÜT K√ä CHI TI√äU -->
    <div id="tab3" class="tab-content" role="tabpanel">
      <h1>üìã LI·ªÜT K√ä CHI TI√äU THEO TH√ÅNG</h1>
      
      <!-- Month Selector -->
      <div class="input-group">
        <select id="monthSelect" aria-label="Ch·ªçn th√°ng">
          <option value="1">Th√°ng 1</option>
          <option value="2">Th√°ng 2</option>
          <option value="3">Th√°ng 3</option>
          <option value="4">Th√°ng 4</option>
          <option value="5">Th√°ng 5</option>
          <option value="6">Th√°ng 6</option>
          <option value="7">Th√°ng 7</option>
          <option value="8">Th√°ng 8</option>
          <option value="9">Th√°ng 9</option>
          <option value="10">Th√°ng 10</option>
          <option value="11">Th√°ng 11</option>
          <option value="12">Th√°ng 12</option>
        </select>
        <button id="fetchExpensesBtn">
          <i class="fas fa-filter"></i> L·ªçc
        </button>
      </div>
      
      <!-- Monthly Expense Summary -->
      <div class="stats-container" id="monthlyExpenseSummary">
        <div class="stat-box income">
          <div class="title">Thu nh·∫≠p</div>
          <div class="amount">0ƒë</div>
        </div>
        <div class="stat-box expense">
          <div class="title">Chi ti√™u</div>
          <div class="amount">0ƒë</div>
        </div>
        <div class="stat-box balance">
          <div class="title">S·ªë d∆∞</div>
          <div class="amount">0ƒë</div>
        </div>
      </div>
      
      <div id="loadingTab3" class="hidden">
        <div class="spinner"></div>
      </div>
      <p id="placeholderTab3" class="notification">
        Ch·ªçn th√°ng v√† nh·∫•n <strong>L·ªçc</strong> ƒë·ªÉ xem chi ti√™u
      </p>
      
      <!-- Expenses List -->
      <div class="transactions-list" id="monthlyExpensesContainer"></div>
      
      <!-- Pagination -->
      <div id="paginationMonthly" class="pagination hidden">
        <button id="prevPageMonthly" class="pagination-btn" disabled>
          <i class="fas fa-chevron-left"></i> Tr∆∞·ªõc
        </button>
        <span id="pageInfoMonthly"></span>
        <button id="nextPageMonthly" class="pagination-btn">
          Sau <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- TAB 4: T√åM KI·∫æM -->
    <div id="tab4" class="tab-content" role="tabpanel">
      <h1>üîç T√åM KI·∫æM GIAO D·ªäCH</h1>
      
      <!-- Search Form -->
      <div class="search-form">
        <div class="input-field">
          <label for="searchKeyword">T·ª´ kh√≥a:</label>
          <input type="text" id="searchKeyword" placeholder="Nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm...">
        </div>
        
        <div class="input-field">
          <label for="searchCategory">Ph√¢n lo·∫°i:</label>
          <select id="searchCategory">
            <option value="">T·∫•t c·∫£</option>
          </select>
        </div>
        
        <div class="input-field">
          <label for="searchAmount">S·ªë ti·ªÅn:</label>
          <input type="text" id="searchAmount" placeholder="VD: 50.000">
        </div>
        
        <button id="searchTransactionsBtn">
          <i class="fas fa-search"></i> T√¨m ki·∫øm
        </button>
      </div>
      
      <div id="loadingTab4" class="hidden">
        <div class="spinner"></div>
      </div>
      <p id="placeholderTab4" class="notification">
        Nh·∫≠p t·ª´ kh√≥a v√† nh·∫•n <strong>T√¨m ki·∫øm</strong>
      </p>
      
      <!-- Search Results -->
      <div class="transactions-list" id="searchResultsContainer"></div>
      
      <!-- Pagination -->
      <div id="paginationSearch" class="pagination hidden">
        <button id="prevPageSearch" class="pagination-btn" disabled>
          <i class="fas fa-chevron-left"></i> Tr∆∞·ªõc
        </button>
        <span id="pageInfoSearch"></span>
        <button id="nextPageSearch" class="pagination-btn">
          Sau <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- TAB 5: QU·∫¢N L√ù T·ª™ KH√ìA -->
    <div id="tab5" class="tab-content" role="tabpanel">
      <h1>üè∑Ô∏è QU·∫¢N L√ù T·ª™ KH√ìA</h1>
      
      <!-- Keyword Form -->
      <div class="keyword-form">
        <div class="input-field">
          <label for="keywordCategory">Ph√¢n lo·∫°i:</label>
          <select id="keywordCategory">
            <option value="">Ch·ªçn ph√¢n lo·∫°i</option>
          </select>
        </div>
        
        <div class="input-field">
          <label for="keywordInput">T·ª´ kh√≥a:</label>
          <input type="text" id="keywordInput" placeholder="VD: cafe, tr√† s·ªØa, ƒë·ªï xƒÉng">
        </div>
        
        <div class="button-group">
          <button id="addKeywordBtn" class="btn-success">
            <i class="fas fa-plus"></i> Th√™m
          </button>
          <button id="deleteKeywordBtn" class="btn-danger">
            <i class="fas fa-trash"></i> X√≥a
          </button>
        </div>
        
        <button id="fetchKeywordsBtn">
          <i class="fas fa-sync"></i> T·∫£i d·ªØ li·ªáu
        </button>
      </div>
      
      <div id="loadingTab5" class="hidden">
        <div class="spinner"></div>
      </div>
      <p id="placeholderTab5" class="notification">
        Nh·∫•n <strong>T·∫£i d·ªØ li·ªáu</strong> ƒë·ªÉ xem danh s√°ch t·ª´ kh√≥a
      </p>
      
      <!-- Keywords List -->
      <div class="keywords-list" id="keywordsContainer"></div>
    </div>

    <!-- TAB 6: GI·ªöI THI·ªÜU -->
    <div id="tab6" class="tab-content" role="tabpanel">
      <h1>‚ÑπÔ∏è GI·ªöI THI·ªÜU</h1>
      
      <div class="info-section">
        <div class="info-card">
          <h2>üì± V·ªÅ MiniApp</h2>
          <p>
            Miniapp t√†i ch√≠nh tr√™n Telegram gi√∫p b·∫°n theo d√µi thu nh·∫≠p v√† chi ti√™u d·ªÖ d√†ng. 
            D·ª±a v√†o d·ªØ li·ªáu trong Google Sheet, n√≥ s·∫Ω hi·ªÉn th·ªã danh s√°ch giao d·ªãch trong ng√†y, 
            bi·ªÉu ƒë·ªì chi ti√™u theo ph√¢n lo·∫°i chi ti·∫øt v√† bi·ªÉu ƒë·ªì thu nh·∫≠p ‚Äì chi ti√™u h√†ng th√°ng 
            ngay trong Telegram.
          </p>
        </div>
        
        <div class="info-card">
          <h2>‚òï ·ª¶ng H·ªô</h2>
          <p>
            N·∫øu b·∫°n th·∫•y n√≥ h·ªØu √≠ch, h√£y ·ªßng h·ªô m√¨nh m·ªôt ly c√† ph√™ ƒë·ªÉ c√≥ th√™m ƒë·ªông l·ª±c 
            duy tr√¨ v√† ph√°t tri·ªÉn nh√©!
          </p>
          <div class="bank-info">
            <p>
              <i class="fas fa-university"></i>
              <strong>Ng√¢n h√†ng:</strong> TMCP S√†i G√≤n ‚Äì H√† N·ªôi (SHB)
            </p>
            <p>
              <i class="fas fa-user"></i>
              <strong>Ch·ªß t√†i kho·∫£n:</strong> Hoang Manh Hung
            </p>
            <p>
              <i class="fas fa-credit-card"></i>
              <strong>S·ªë t√†i kho·∫£n:</strong> 6666.6789.9999
            </p>
          </div>
        </div>
        
        <div class="qr-container">
          <div class="qr-frame">
            <img src="https://i.pinimg.com/736x/7c/13/53/7c135389e26cbc6460626deb9e2aa5c6.jpg" 
                 alt="QR Code Momo" 
                 class="qr-image"
                 loading="lazy">
          </div>
          <p class="qr-caption">Qu√©t m√£ QR ƒë·ªÉ ·ªßng h·ªô qua Momo</p>
        </div>
        
        <div class="info-card">
          <h2>üìû Li√™n H·ªá</h2>
          <div class="contact-info">
            <p>
              <i class="fab fa-telegram-plane"></i>
              <strong>Telegram:</strong> 
              <a href="https://t.me/masterhmh" target="_blank" rel="noopener">@masterhmh</a>
            </p>
            <p>
              <i class="fab fa-facebook"></i>
              <strong>Facebook:</strong> 
              <a href="https://facebook.com/masterhmh" target="_blank" rel="noopener">facebook.com/masterhmh</a>
            </p>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- ================================================================
       MODALS
       ================================================================ -->
  
  <!-- Edit Transaction Modal -->
  <div id="editModal" class="modal" role="dialog" aria-labelledby="editModalTitle">
    <div class="modal-content">
      <h2 id="editModalTitle">‚úèÔ∏è Ch·ªânh s·ª≠a giao d·ªãch</h2>
      <div id="editError" class="error-message hidden"></div>
      <form id="editForm">
        <div class="form-group">
          <label for="editTransactionId">M√£ giao d·ªãch:</label>
          <input type="text" id="editTransactionId" readonly>
        </div>
        <div class="form-group">
          <label for="editDate">Ng√†y:</label>
          <input type="date" id="editDate" required>
        </div>
        <div class="form-group">
          <label for="editContent">N·ªôi dung:</label>
          <input type="text" id="editContent" placeholder="Nh·∫≠p n·ªôi dung giao d·ªãch" required>
        </div>
        <div class="form-group">
          <label for="editAmount">S·ªë ti·ªÅn:</label>
          <input type="text" id="editAmount" placeholder="VD: 50.000" required>
        </div>
        <div class="form-group">
          <label for="editType">Ph√¢n lo·∫°i:</label>
          <select id="editType" required>
            <option value="Thu nh·∫≠p">Thu nh·∫≠p</option>
            <option value="Chi ti√™u">Chi ti√™u</option>
          </select>
        </div>
        <div class="form-group">
          <label for="editCategory">Ph√¢n lo·∫°i chi ti·∫øt:</label>
          <select id="editCategory" required></select>
        </div>
        <div class="form-group">
          <label for="editNote">Ghi ch√∫:</label>
          <textarea id="editNote" placeholder="Nh·∫≠p ghi ch√∫ (t√πy ch·ªçn)"></textarea>
        </div>
        <div class="btn-group">
          <button type="button" class="cancel-btn" onclick="closeEditForm()">H·ªßy</button>
          <button type="submit" class="save-btn">L∆∞u</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Transaction Modal -->
  <div id="addModal" class="modal" role="dialog" aria-labelledby="addModalTitle">
    <div class="modal-content">
      <h2 id="addModalTitle">‚ûï Th√™m giao d·ªãch m·ªõi</h2>
      <div id="addError" class="error-message hidden"></div>
      <form id="addForm">
        <div class="form-group">
          <label for="addDate">Ng√†y:</label>
          <input type="date" id="addDate" required>
        </div>
        <div class="form-group">
          <label for="addContent">N·ªôi dung:</label>
          <input type="text" id="addContent" placeholder="Nh·∫≠p n·ªôi dung giao d·ªãch" required>
        </div>
        <div class="form-group">
          <label for="addAmount">S·ªë ti·ªÅn:</label>
          <input type="text" id="addAmount" placeholder="VD: 50.000" required>
        </div>
        <div class="form-group">
          <label for="addType">Ph√¢n lo·∫°i:</label>
          <select id="addType" required>
            <option value="Thu nh·∫≠p">Thu nh·∫≠p</option>
            <option value="Chi ti√™u">Chi ti√™u</option>
          </select>
        </div>
        <div class="form-group">
          <label for="addCategory">Ph√¢n lo·∫°i chi ti·∫øt:</label>
          <select id="addCategory" required></select>
        </div>
        <div class="form-group">
          <label for="addNote">Ghi ch√∫:</label>
          <textarea id="addNote" placeholder="Nh·∫≠p ghi ch√∫ (t√πy ch·ªçn)"></textarea>
        </div>
        <div class="btn-group">
          <button type="button" class="cancel-btn" onclick="closeAddForm()">H·ªßy</button>
          <button type="submit" class="save-btn">L∆∞u</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="confirmDeleteModal" class="modal" role="dialog">
    <div class="modal-content">
      <h2>‚ö†Ô∏è X√°c nh·∫≠n x√≥a</h2>
      <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a giao d·ªãch n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.</p>
      <div class="btn-group">
        <button type="button" class="cancel-btn" onclick="closeConfirmDeleteModal()">H·ªßy</button>
        <button type="button" class="save-btn btn-danger" id="confirmDeleteBtn">X√≥a</button>
      </div>
    </div>
  </div>

  <!-- ================================================================
       SCRIPTS
       ================================================================ -->
  <script src="script.js"></script>
</body>
</html>
