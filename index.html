<!DOCTYPE html>
<html lang="vi">
<head>
  <!-- ================================================================
       üí∞ MINIAPP T√ÄI CH√çNH - TELEGRAM BOT
       K·∫øt h·ª£p: B·ªë c·ª•c c≈© + Animation m·ªõi + Icons hi·ªán ƒë·∫°i
       ================================================================ -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Qu·∫£n l√Ω t√†i ch√≠nh c√° nh√¢n th√¥ng minh">
  <meta name="theme-color" content="#6366F1">
  <title>üí∞ Mini App T·ªïng Quan Chi Ti√™u</title>
  
  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
</head>
<body>
  
  <!-- ================================================================
       HEADER & NAVIGATION
       ================================================================ -->
  <div class="app-header">
    <h3>¬©masterhmh</h3>
  </div>
  
  <nav class="top-nav" role="navigation" aria-label="Main navigation">
    <div class="nav-item active" data-tab="tab1" role="tab" aria-selected="true">
      <i class="fas fa-exchange-alt" aria-hidden="true"></i>
      <span>Giao d·ªãch</span>
    </div>
    <div class="nav-item" data-tab="tab2" role="tab">
      <i class="fas fa-chart-pie" aria-hidden="true"></i>
      <span>B√°o C√°o</span>
    </div>
    <div class="nav-item" data-tab="tab3" role="tab">
      <i class="fas fa-receipt" aria-hidden="true"></i>
      <span>Li·ªát k√™</span>
    </div>
    <div class="nav-item" data-tab="tab4" role="tab">
      <i class="fas fa-search" aria-hidden="true"></i>
      <span>T√¨m ki·∫øm</span>
    </div>
    <div class="nav-item" data-tab="tab5" role="tab">
      <i class="fas fa-tags" aria-hidden="true"></i>
      <span>T·ª´ kh√≥a</span>
    </div>
    <div class="nav-item" data-tab="tab6" role="tab">
      <i class="fas fa-info-circle" aria-hidden="true"></i>
      <span>Gi·ªõi thi·ªáu</span>
    </div>
  </nav>

  <!-- ================================================================
       MAIN CONTENT
       ================================================================ -->
  <div class="content-wrapper">
    
    <!-- TAB 1: GIAO D·ªäCH TRONG NG√ÄY -->
    <div id="tab1" class="tab-content active" role="tabpanel">
      <h1>GIAO D·ªäCH TRONG NG√ÄY</h1>
      <p class="notification">Vui l√≤ng ch·ªçn ng√†y v√† ·∫•n "L·ªçc" ƒë·ªÉ xem c√°c giao d·ªãch c√≥ trong ng√†y.</p>
      <div id="errorMessageTab1" style="color: red; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="successMessageTab1" style="color: green; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="loadingTab1" style="display: none; text-align: center; margin: 1rem 0;">
        <div class="spinner"></div>
      </div>
      <div class="input-group">
        <input type="date" id="transactionDate" aria-label="Ch·ªçn ng√†y">
        <button id="fetchTransactionsBtn">
          <i class="fas fa-filter"></i> L·ªçc
        </button>
        <button id="addTransactionBtn" class="btn-success">
          <i class="fas fa-plus"></i> Th√™m
        </button>
      </div>
      <div class="stats-container" id="dailySummary">
        <div class="stat-box income"><div class="title">Thu nh·∫≠p</div><div class="amount">0ƒë</div></div>
        <div class="stat-box expense"><div class="title">Chi ti√™u</div><div class="amount">0ƒë</div></div>
        <div class="stat-box balance"><div class="title">S·ªë d∆∞</div><div class="amount">0ƒë</div></div>
      </div>
      <p id="placeholderTab1" class="notification" style="margin-top: 1rem;">D·ªØ li·ªáu giao d·ªãch hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
      <div class="transactions-list" id="transactionsContainer"></div>
      <div id="pagination" style="text-align: center; margin-top: 1rem; display: none;">
        <button id="prevPage" class="pagination-btn" disabled>
          <i class="fas fa-chevron-left"></i> Trang tr∆∞·ªõc
        </button>
        <span id="pageInfo"></span>
        <button id="nextPage" class="pagination-btn">
          Trang sau <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- TAB 2: B√ÅO C√ÅO THU CHI THEO TH√ÅNG -->
    <div id="tab2" class="tab-content" role="tabpanel">
      <h1>B√ÅO C√ÅO THU CHI THEO TH√ÅNG</h1>
      <p class="notification">Vui l√≤ng ch·ªçn kho·∫£ng th·ªùi gian v√† ·∫•n "L·ªçc" ƒë·ªÉ xem b√°o c√°o.</p>
      <div id="errorMessageTab2" style="color: red; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="successMessageTab2" style="color: green; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="loadingTab2" style="display: none; text-align: center; margin: 1rem 0;">
        <div class="spinner"></div>
      </div>
      <div class="input-group">
        T·ª´:
        <select id="startMonth" aria-label="Th√°ng b·∫Øt ƒë·∫ßu">
          <option value="1">Th√°ng 1</option><option value="2">Th√°ng 2</option><option value="3">Th√°ng 3</option>
          <option value="4">Th√°ng 4</option><option value="5">Th√°ng 5</option><option value="6">Th√°ng 6</option>
          <option value="7">Th√°ng 7</option><option value="8">Th√°ng 8</option><option value="9">Th√°ng 9</option>
          <option value="10">Th√°ng 10</option><option value="11">Th√°ng 11</option><option value="12">Th√°ng 12</option>
        </select>
        ƒê·∫øn:
        <select id="endMonth" aria-label="Th√°ng k·∫øt th√∫c">
          <option value="1">Th√°ng 1</option><option value="2">Th√°ng 2</option><option value="3">Th√°ng 3</option>
          <option value="4">Th√°ng 4</option><option value="5">Th√°ng 5</option><option value="6">Th√°ng 6</option>
          <option value="7">Th√°ng 7</option><option value="8">Th√°ng 8</option><option value="9">Th√°ng 9</option>
          <option value="10">Th√°ng 10</option><option value="11">Th√°ng 11</option><option value="12">Th√°ng 12</option>
        </select>
        <button id="fetchMonthlyDataBtn">
          <i class="fas fa-filter"></i> L·ªçc
        </button>
      </div>
      <div class="stats-container" id="monthlyStatsContainer">
        <div class="stat-box income"><div class="title">Thu nh·∫≠p</div><div class="amount">0ƒë</div></div>
        <div class="stat-box expense"><div class="title">Chi ti√™u</div><div class="amount">0ƒë</div></div>
        <div class="stat-box balance"><div class="title">S·ªë d∆∞</div><div class="amount">0ƒë</div></div>
      </div>
      <p id="placeholderTab2" class="notification" style="margin-top: 1rem;">D·ªØ li·ªáu b√°o c√°o s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
      <h1 id="chartTitleTab2" style="margin-top: 2rem; display: none;">BI·ªÇU ƒê·ªí THU CHI THEO TH√ÅNG</h1>
      <canvas id="monthlyChart"></canvas>
      <div class="chart-container">
        <h1 id="pieChartTitleTab2" style="display: none;">CHI TI√äU THEO PH√ÇN LO·∫†I</h1>
        <div class="pie-chart-wrapper">
          <canvas id="monthlyPieChart"></canvas>
        </div>
        <div class="custom-legend" id="monthlyCustomLegend"></div>
      </div>
    </div>
    
    <!-- TAB 3: LI·ªÜT K√ä CHI TI√äU THEO TH√ÅNG -->
    <div id="tab3" class="tab-content" role="tabpanel">
      <h1>LI·ªÜT K√ä CHI TI√äU THEO TH√ÅNG</h1>
      <p class="notification">Ch·ªçn th√°ng v√† ·∫•n "L·ªçc" ƒë·ªÉ xem danh s√°ch chi ti√™u trong th√°ng.</p>
      <div id="errorMessageTab3" style="color: red; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="successMessageTab3" style="color: green; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="loadingTab3" style="display: none; text-align: center; margin: 1rem 0;">
        <div class="spinner"></div>
      </div>
      <div class="input-group">
        <select id="monthSelect" aria-label="Ch·ªçn th√°ng">
          <option value="1">Th√°ng 1</option><option value="2">Th√°ng 2</option><option value="3">Th√°ng 3</option>
          <option value="4">Th√°ng 4</option><option value="5">Th√°ng 5</option><option value="6">Th√°ng 6</option>
          <option value="7">Th√°ng 7</option><option value="8">Th√°ng 8</option><option value="9">Th√°ng 9</option>
          <option value="10">Th√°ng 10</option><option value="11">Th√°ng 11</option><option value="12">Th√°ng 12</option>
        </select>
        <button id="fetchExpensesBtn">
          <i class="fas fa-filter"></i> L·ªçc
        </button>
      </div>
      <div class="stats-container" id="monthlyExpenseSummary">
        <div class="stat-box income"><div class="title">Thu nh·∫≠p</div><div class="amount">0ƒë</div></div>
        <div class="stat-box expense"><div class="title">Chi ti√™u</div><div class="amount">0ƒë</div></div>
        <div class="stat-box balance"><div class="title">S·ªë d∆∞</div><div class="amount">0ƒë</div></div>
      </div>
      <p id="placeholderTab3" class="notification" style="margin-top: 1rem;">C√°c giao d·ªãch trong th√°ng s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
      <div class="transactions-list" id="monthlyExpensesContainer"></div>
      <div id="paginationMonthly" style="text-align: center; margin-top: 1rem; display: none;">
        <button id="prevPageMonthly" class="pagination-btn" disabled>
          <i class="fas fa-chevron-left"></i> Trang tr∆∞·ªõc
        </button>
        <span id="pageInfoMonthly"></span>
        <button id="nextPageMonthly" class="pagination-btn">
          Trang sau <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- TAB 4: T√åM KI·∫æM GIAO D·ªäCH -->
    <div id="tab4" class="tab-content" role="tabpanel">
      <h1>T√åM KI·∫æM GIAO D·ªäCH</h1>
      <p class="notification">Nh·∫≠p t·ª´ kh√≥a, ch·ªçn kho·∫£ng th·ªùi gian v√† ·∫•n "T√¨m ki·∫øm" ƒë·ªÉ t√¨m ki·∫øm giao d·ªãch.</p>
      <div id="errorMessageTab4" style="color: red; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="successMessageTab4" style="color: green; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="loadingTab4" style="display: none; text-align: center; margin: 1rem 0;">
        <div class="spinner"></div>
      </div>
      <div class="search-transaction">
        <div class="search-field">
          <label for="searchKeyword">T·ª´ kh√≥a:</label>
          <input type="text" id="searchKeyword" placeholder="Nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm (VD: cafe, tr√† s·ªØa)">
        </div>
        <div class="search-field">
          <label for="searchStartDate">T·ª´ ng√†y:</label>
          <input type="date" id="searchStartDate">
        </div>
        <div class="search-field">
          <label for="searchEndDate">ƒê·∫øn ng√†y:</label>
          <input type="date" id="searchEndDate">
        </div>
        <button type="submit" id="searchBtn">
          <i class="fas fa-search"></i> T√¨m ki·∫øm
        </button>
        <button type="button" id="clearSearchBtn">
          <i class="fas fa-eraser"></i> X√≥a
        </button>
      </div>
      <p id="placeholderTab4" class="notification" style="margin-top: 1rem;">K·∫øt qu·∫£ t√¨m ki·∫øm s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
      <div class="transactions-list" id="searchResultsContainer"></div>
      <div id="paginationSearch" style="text-align: center; margin-top: 1rem; display: none;">
        <button id="prevPageSearch" class="pagination-btn" disabled>
          <i class="fas fa-chevron-left"></i> Trang tr∆∞·ªõc
        </button>
        <span id="pageInfoSearch"></span>
        <button id="nextPageSearch" class="pagination-btn">
          Trang sau <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </div>

    <!-- TAB 5: QU·∫¢N L√ù T·ª™ KH√ìA -->
    <div id="tab5" class="tab-content" role="tabpanel">
      <h1>QU·∫¢N L√ù T·ª™ KH√ìA</h1>
      <p class="notification">Ch·ªçn ph√¢n lo·∫°i chi ti·∫øt v√† nh·∫≠p t·ª´ kh√≥a ƒë·ªÉ th√™m ho·∫∑c x√≥a kh·ªèi sheet "T·ª´ kh√≥a".</p>
      <div id="errorMessageTab5" style="color: red; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="successMessageTab5" style="color: green; text-align: center; display: none; margin-bottom: 1rem;"></div>
      <div id="loadingTab5" style="display: none; text-align: center; margin: 1rem 0;">
        <div class="spinner"></div>
      </div>
      <div class="input-group vertical">
        <div class="input-field">
          <label>Ph√¢n lo·∫°i chi ti·∫øt: </label>
          <select id="keywordCategory" class="uniform-input">
            <option value="">Ch·ªçn ph√¢n lo·∫°i</option>
          </select>
        </div>
        <div class="input-field">
          <label>T·ª´ kh√≥a: </label>
          <input type="text" id="keywordInput" class="uniform-input" placeholder="Nh·∫≠p t·ª´ kh√≥a (VD: ƒë·ªï d·∫ßu, ƒë·ªï xƒÉng)">
        </div>
        <div class="button-group">
          <button id="addKeywordBtn" class="btn-success">
            <i class="fas fa-plus"></i> Th√™m t·ª´ kh√≥a
          </button>
          <button id="deleteKeywordBtn" class="btn-danger">
            <i class="fas fa-trash"></i> X√≥a t·ª´ kh√≥a
          </button>
        </div>
        <button id="fetchKeywordsBtn">
          <i class="fas fa-sync"></i> T·∫£i d·ªØ li·ªáu
        </button>
      </div>
      <p id="placeholderTab5" class="notification" style="margin-top: 1rem;">D·ªØ li·ªáu t·ª´ kh√≥a s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</p>
      <div class="keywords-list" id="keywordsContainer"></div>
    </div>

    <!-- TAB 6: GI·ªöI THI·ªÜU -->
    <div id="tab6" class="tab-content" role="tabpanel">
      <h1>GI·ªöI THI·ªÜU</h1>
      <div class="info-section">
        <div class="info-card">
          <h1>V·ªÅ MiniApp</h1>
          <p class="custom-text">Miniapp t√†i ch√≠nh tr√™n Telegram gi√∫p b·∫°n theo d√µi thu nh·∫≠p v√† chi ti√™u d·ªÖ d√†ng. D·ª±a v√†o d·ªØ li·ªáu trong Google Sheet, n√≥ s·∫Ω hi·ªÉn th·ªã danh s√°ch giao d·ªãch trong ng√†y, bi·ªÉu ƒë·ªì chi ti√™u theo ph√¢n lo·∫°i chi ti·∫øt v√† bi·ªÉu ƒë·ªì thu nh·∫≠p ‚Äì chi ti√™u h√†ng th√°ng ngay trong Telegram.</p>
        </div>
        <div class="info-card">
          <h1>·ª¶ng H·ªô</h1>
          <p class="custom-text">N·∫øu b·∫°n th·∫•y n√≥ h·ªØu √≠ch, h√£y ·ªßng h·ªô m√¨nh m·ªôt ly c√† ph√™ ƒë·ªÉ c√≥ th√™m ƒë·ªông l·ª±c duy tr√¨ v√† ph√°t tri·ªÉn nh√©!</p>
          <p><i class="fas fa-university" style="color: var(--primary-color);"></i><strong>Ng√¢n h√†ng:</strong> TMCP S√†i G√≤n ‚Äì H√† N·ªôi (SHB)</p>
          <p><i class="fas fa-user" style="color: var(--primary-color);"></i><strong>Ch·ªß t√†i kho·∫£n:</strong> Hoang Manh Hung</p>
          <p><i class="fas fa-credit-card" style="color: var(--primary-color);"></i><strong>S·ªë t√†i kho·∫£n:</strong> 6666.6789.9999</p>
        </div>
        <div class="qr-container">
          <div class="qr-frame">
            <img id="qrImage" src="https://i.pinimg.com/736x/7c/13/53/7c135389e26cbc6460626deb9e2aa5c6.jpg" alt="QR Code" class="qr-image" loading="lazy">
          </div>
          <p class="qr-caption">Qu√©t m√£ QR ƒë·ªÉ ·ªßng h·ªô qua Momo</p>
        </div>
        <div class="info-card">
          <h1>Li√™n H·ªá</h1>
          <div class="contact-columns">
            <p><i class="fab fa-telegram-plane" style="color: var(--primary-color);"></i><strong>Telegram:</strong> <a href="https://t.me/masterhmh" target="_blank" rel="noopener">@masterhmh</a></p>
            <p><i class="fab fa-facebook" style="color: var(--primary-color);"></i><strong>Facebook:</strong> <a href="https://facebook.com/masterhmh" target="_blank" rel="noopener">facebook.com/masterhmh</a></p>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- ================================================================
       MODALS
       ================================================================ -->
  
  <!-- Edit Transaction Modal -->
  <div id="editModal" class="modal" role="dialog" aria-labelledby="editModalTitle">
    <div class="modal-content">
      <h2 id="editModalTitle">Ch·ªânh s·ª≠a giao d·ªãch</h2>
      <div id="editError" class="error-message"></div>
      <form id="editForm">
        <label for="editTransactionId">M√£ giao d·ªãch:</label>
        <input type="text" id="editTransactionId" readonly>
        <label for="editDate">Ng√†y:</label>
        <input type="date" id="editDate" required>
        <label for="editContent">N·ªôi dung:</label>
        <input type="text" id="editContent" placeholder="Nh·∫≠p n·ªôi dung giao d·ªãch" required>
        <label for="editAmount">S·ªë ti·ªÅn:</label>
        <input type="text" id="editAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VD: 5.000)" required>
        <label for="editType">Ph√¢n lo·∫°i:</label>
        <select id="editType" required>
          <option value="Thu nh·∫≠p">Thu nh·∫≠p</option>
          <option value="Chi ti√™u">Chi ti√™u</option>
        </select>
        <label for="editCategory">Ph√¢n lo·∫°i chi ti·∫øt:</label>
        <select id="editCategory" required></select>
        <label for="editNote">Ghi ch√∫ (n·∫øu c√≥):</label>
        <textarea id="editNote" placeholder="Nh·∫≠p ghi ch√∫ (t√πy ch·ªçn)"></textarea>
        <div class="btn-group">
          <button type="button" class="cancel-btn" onclick="closeEditForm()">
            <i class="fas fa-times"></i> H·ªßy
          </button>
          <button type="submit" class="save-btn">
            <i class="fas fa-save"></i> L∆∞u
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add Transaction Modal -->
  <div id="addModal" class="modal" role="dialog" aria-labelledby="addModalTitle">
    <div class="modal-content">
      <h2 id="addModalTitle">Th√™m giao d·ªãch m·ªõi</h2>
      <div id="addError" class="error-message"></div>
      <form id="addForm">
        <label for="addDate">Ng√†y:</label>
        <input type="date" id="addDate" required>
        <label for="addContent">N·ªôi dung:</label>
        <input type="text" id="addContent" placeholder="Nh·∫≠p n·ªôi dung giao d·ªãch" required>
        <label for="addAmount">S·ªë ti·ªÅn:</label>
        <input type="text" id="addAmount" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VD: 5.000)" required>
        <label for="addType">Ph√¢n lo·∫°i:</label>
        <select id="addType" required>
          <option value="Thu nh·∫≠p">Thu nh·∫≠p</option>
          <option value="Chi ti√™u">Chi ti√™u</option>
        </select>
        <label for="addCategory">Ph√¢n lo·∫°i chi ti·∫øt:</label>
        <select id="addCategory" required></select>
        <label for="addNote">Ghi ch√∫ (n·∫øu c√≥):</label>
        <textarea id="addNote" placeholder="Nh·∫≠p ghi ch√∫ (t√πy ch·ªçn)"></textarea>
        <div class="btn-group">
          <button type="button" class="cancel-btn" onclick="closeAddForm()">
            <i class="fas fa-times"></i> H·ªßy
          </button>
          <button type="submit" class="save-btn">
            <i class="fas fa-save"></i> L∆∞u
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="confirmDeleteModal" class="modal" role="dialog">
    <div class="modal-content">
      <h2>X√°c nh·∫≠n x√≥a</h2>
      <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a giao d·ªãch n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.</p>
      <div class="btn-group">
        <button type="button" class="cancel-btn" onclick="closeConfirmDeleteModal()">
          <i class="fas fa-times"></i> H·ªßy
        </button>
        <button type="button" class="save-btn btn-danger" id="confirmDeleteBtn">
          <i class="fas fa-trash"></i> X√≥a
        </button>
      </div>
    </div>
  </div>

  <!-- ================================================================
       SCRIPTS
       ================================================================ -->
  <script src="script.js"></script>
</body>
</html>
